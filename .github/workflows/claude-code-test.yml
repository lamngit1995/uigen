name: Claude Code Integration Test

on:
  push:
    branches: [ master, main ]
  pull_request:
    branches: [ master, main ]
  workflow_dispatch:  # Manual trigger for testing

jobs:
  integration-check:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout code
      uses: actions/checkout@v4

    - name: Display repository info
      run: |
        echo "ü§ñ Claude Code Integration Test"
        echo "================================"
        echo ""
        echo "Repository: ${{ github.repository }}"
        echo "Owner: ${{ github.repository_owner }}"
        echo "Branch: ${{ github.ref_name }}"
        echo "SHA: ${{ github.sha }}"
        echo ""
        echo "Event Details:"
        echo "  Type: ${{ github.event_name }}"
        echo "  Actor: ${{ github.actor }}"
        echo ""

    - name: Check for CLAUDE.md
      run: |
        if [ -f "CLAUDE.md" ]; then
          echo "‚úÖ CLAUDE.md found!"
          echo "üìÑ First few lines:"
          head -10 CLAUDE.md
        else
          echo "‚ö†Ô∏è  CLAUDE.md not found"
        fi

    - name: Verify project structure
      run: |
        echo "üìÅ Key directories:"
        echo "  src/: $([ -d src ] && echo '‚úÖ' || echo '‚ùå')"
        echo "  .github/: $([ -d .github ] && echo '‚úÖ' || echo '‚ùå')"
        echo "  prisma/: $([ -d prisma ] && echo '‚úÖ' || echo '‚ùå')"
        echo ""
        echo "üìÑ Key files:"
        echo "  package.json: $([ -f package.json ] && echo '‚úÖ' || echo '‚ùå')"
        echo "  README.md: $([ -f README.md ] && echo '‚úÖ' || echo '‚ùå')"
        echo "  tsconfig.json: $([ -f tsconfig.json ] && echo '‚úÖ' || echo '‚ùå')"

    - name: Installation success message
      run: |
        echo ""
        echo "üéâ GitHub Actions Integration Test Complete!"
        echo "==========================================="
        echo ""
        echo "‚úÖ This workflow ran successfully, which means:"
        echo "   1. GitHub Actions is properly configured"
        echo "   2. The repository is accessible"
        echo "   3. Workflows can checkout and read the code"
        echo ""
        echo "If you see this message, the basic integration is working!"
        echo ""
        echo "For Claude Code App verification, check:"
        echo "  ‚Üí https://github.com/settings/installations"
        echo "  ‚Üí Look for 'Claude Code Action' with access to this repo"
